--
-- Author: Mirko Bez
-- 
-- Exercise 1
-- 

import Control.Applicative
--help gs xs = [g x | (g,x) <- zip gs xs]

newtype FooList a = F [a] deriving Show

instance Functor FooList where 
	--fmap :: (a -> b) -> ZipList a -> ZipList b
	fmap g (F xs) = F (fmap g xs)

instance Applicative FooList where
	--pure :: a -> ZipList a
	pure x = F (repeat x)
	-- <*> :: ZipList (a->b) -> ZipList a -> ZipList b
	(F gs) <*> (F xs) = F [g x | (g,x) <- zip gs xs]

--
-- Exercise 2
--

--
--
--
exA l1 l2 l3 = [x:y:z:[] | x <- l1, y <- l2, z <- l3]

---
---
---
exB :: [Int] -> [Int] -> [Int] -> [[Int]]
exB l1 l2 l3 = toList(pure (\x -> \y -> \z -> x:y:z:[]) <*> F l1 <*> F l2 <*> F l3)

--
--
--
exC :: [[Int]] -> [[Int]]
exC l = toList(pure (\g -> \y -> map g y) <*>  F (map (+) [1..]) <*> F l)

-- Function that extract the list from the dummy container
toList :: FooList a -> [a]
toList (F xs) = xs




